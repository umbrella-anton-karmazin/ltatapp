# LTATApp

Статус: **в активной разработке (WIP)**. Репозиторий пока не готов для использования “как есть”: API/форматы данных/UX могут меняться без обратной совместимости.

LTATApp — нативное macOS-приложение для локального трекинга времени “квантами” (по умолчанию 3 минуты) с явным Start/Stop, сбором агрегированных сигналов активности и подготовкой артефактов (скриншоты/фокус/отчеты) для последующей синхронизации на сервер (в будущем; сейчас без сетевого I/O).

## Что уже есть

- Swift/SwiftUI приложение (SwiftPM, macOS 13+): `mac-app/`
- Онбординг и проверка разрешений (Screen Recording / Accessibility / Input Monitoring)
- Квантизатор с поддержкой `partial` / `too_short` по конфигу и auto-pause на sleep/screens sleep/lock
- Сбор агрегированной активности за квант (keypress/click/scroll/mouse distance) и расчет `activity_percent` по конфигу
- Локальное логирование/audit событий и миграции схемы (MVP scaffolding)

## Что в планах (high-level)

- Трекинг фокуса и переключений (frontmost app, bundleId→category, аномалии)
- Захват скриншотов (multi-display, downscale, JPEG/HEIC) и политика хранения
- Сохранение данных кванта/агрегатов/метаданных в локальное хранилище и очистка по retention
- Генерация HTML-отчетов и интеграция AI mock-анализатора (без отправки данных наружу)
- Packaging/QA: подпись/нотаризация, автозапуск helper-а, sanity-checks

Актуальный список задач и порядок работ: `TASKS.md`. Архитектура/допущения: `PLAN.md`. Принятые решения: `DECISIONS.md`.

## Сборка и запуск (macOS 13+)

Требования: Xcode/Command Line Tools со Swift 6.

```bash
cd mac-app
swift build
swift run LTATApp
```

Проект использует одну исполняемую сборку; helper-режим запускается флагом `--helper` (нужен для LaunchAgent-сценариев в будущем).

## Разрешения и приватность

Приложение рассчитано на локальную работу “offline-first”.

- Screen Recording — нужен для будущего захвата скриншотов (и проверки готовности)
- Accessibility / Input Monitoring — нужны для корректного сбора сигналов активности
- Данные о вводе собираются **в агрегированном виде** (счетчики/дистанция), без сохранения “сырого” текста/клавиш
- Синхронизация на сервер пока **не реализована**; сетевых запросов проект не делает

## Конфиг

Конфигурация трекинга/порогов/формулы активности/категорий приложений и будущих параметров скриншотов/retention описана в `PLAN.md` и используется приложением через JSON/YAML-конфиги (детали будут вынесены в отдельный документ по мере стабилизации формата).

## Contributing

Если хотите помочь — заведите issue/обсуждение с описанием сценария и ожидаемого поведения. Для крупных изменений лучше сначала согласовать в `PLAN.md`/`DECISIONS.md`.

## License

TBD.
