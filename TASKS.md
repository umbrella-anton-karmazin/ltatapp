# TASKS

Created 2025-02-28.

- [x] Черновой HLD и обзор архитектуры (2025-02-28) — зафиксировано в PLAN.md.
- [x] Уточнить пороги подсчета активности и таймаут простоя со стейкхолдерами.
- [x] Определить минимальное разрешение/формат скриншотов и ограничения по хранению (2025-02-28) — дефолт 1280px по ширине, JPEG/HEIC; хранить до подтвержденного синка, пока нет синка — 7 дней.
- [x] Подтвердить выбор десктопного стека (нативный Swift/SwiftUI + helper) или альтернативы (2025-02-28) — принято Swift/SwiftUI + AppKit (при необходимости), helper через LaunchAgent/XPC.
- [x] Оценить реализуемость и политику приватности для сигналов аудио/камеры (2025-02-28) — принято: не делать в MVP.
- [x] Сформировать MVP-бэклог и порядок работ для Mac (трекинг, захват, отчеты, заглушка синка) (2025-02-28) — зафиксировано в PLAN.md (Update 2025-02-28: MVP-бэклог).
- [x] Задокументировать конфигурационный файл (JSON/YAML): квант, partial, активность (K_MAX/веса/пороги), категории приложений, пороги аномалий, параметры скриншотов, retention (future) (2025-02-28) — зафиксировано в PLAN.md (Update 2025-02-28: Конфиг...).
- [x] Специфицировать схему данных: Project, Task, Quantum (partial/too_short, actualDurationSeconds), ActivityAggregate, FocusAggregate, ScreenshotMetadata; предусмотреть флаг `enableRawEvents` (2025-02-28) — зафиксировано в PLAN.md (Update 2025-02-28: Конфиг...).
- [x] Определить контракт `AIReportAnalyzer.analyze` (payload входа/выхода), формат mock-ответа и логирование без скриншотов (2025-02-28) — описано в PLAN.md (Update 2025-02-28: Конфиг...).
- [x] Описать структуру HTML-отчета: метрики дня, график активности, топ приложений, переключения, таймлайн квантов со скриншотами, аномалии (2025-02-28) — описано в PLAN.md.
- [x] Проработать UX-флоу MVP: онбординг/permissions, главный экран (статус, проект/задача, Start/Stop), Today view, превью отчета, настройки; учесть авто-паузу/возврат (2025-02-28) — описано в PLAN.md.
- [x] Предложить дефолтные пороги/веса для активности и минимальную длительность partial-кванта (drop vs `too_short`) (2025-02-28) — K_MAX=150, C_MAX=90, S_MAX=120, M_MAX=5000px, веса 0.4/0.25/0.2/0.15, low activity <20%; partial: <30s drop, 30–120s `too_short`, ≥120s normal partial.
- [x] Составить базовый список bundleId → category для популярных браузеров, IDE, офисных пакетов, мессенджеров и т.д. (2025-02-28) — зафиксировано в PLAN.md (Update 2025-02-28).
- [ ] Реализовать загрузку конфига (JSON/YAML), базовый UI-шелл, логирование/аудит, структуру БД/миграции.
- [ ] Реализовать permissions/onboarding (Screen Recording, Accessibility, Input Monitoring), обработку отказов и установку LaunchAgent.
- [ ] Реализовать state machine и квантайзер: статусы stopped/tracking/paused_by_system, partial-логика (drop/too_short), авто-пауза при sleep/display off, попап возобновления.
- [ ] Реализовать агрегирование активности: сбор counts (keypress/click/scroll/mouse distance), расчет activity_percent по конфигу, idle/low-activity флаги.
- [ ] Реализовать трекинг фокуса и переключений: frontmost app, bundleId→category, счетчики переключений (квант/час/день), флаги focus_mode/anomaly_switching.
- [ ] Реализовать захват скриншотов: все дисплеи, даунскейл до 1280px (конфиг), JPEG/HEIC, сохранение на ФС и метаданные.
- [ ] Привязать хранилище: запись Session/Quantum/ActivityAggregate/FocusAggregate/ScreenshotMetadata/AuditLog, индексы, очистка по политике хранения (неделя пока без синка).
- [ ] Генерировать HTML-отчет (конец дня + по запросу) с метриками/графиками/таймлайном скринов/аномалиями.
- [ ] Интегрировать AI mock `AIReportAnalyzer` в отчет (логирование payload, мок-ответ).
- [ ] Полировать UX: главный экран Start/Stop + проект/задача, Today view, Report preview, Settings (конфиг/приватность/retention).
- [ ] Реализовать sync stub: очередь SyncQueue, упаковка payload кванта (без отправки), удержание скринов/логов до подтверждения.
- [ ] Packaging/QA: подпись/нотаризация, автозапуск helper-а, sanity-тесты квантов, отчетов, хранения/очистки.
